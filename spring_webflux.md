# 🌊 Spring WebFlux

## 👏🏼 리액티브 프로그래밍(Reactive Programming) 맛보기

오늘의 TIL 주제는 리액티브 프로그래밍이다.

개발자 모임에서 Spring WebFlux에 대한 이야기가 나왔었고, 강의를 들으면서 이 기술에 대해 한번 더 들었다. 그리고 현재 파견온 회사에서 이 기술을 쓰는 것을 보고, 3번이나 마주쳤으니 그럼 내가 직접 공부해보자. 라는 생각을 하게 되었다.

모르는 것은 방대한데 모든 것을 다 공부할 수는 없으니, 3번 정도 듣고 보게 되면 그때는 공부를 시작하자, 는 유튜브를 본 적이 있기 때문이다.

그런데 이 Spring WebFlux는 리액티브 프로그래밍 기반으로 만들어진 웹 프레임워크이기 때문에 리액티브 프로그래밍에 대해 먼저 이해할 필요가 있다고 생각했다.

---

# Reactive Programming

**비동기적이고 이벤트 기반**의 데이터 흐름을 처리하는 프로그래밍 패러다임이다.

차례대로 동기로 처리하지 않고, 이벤트 성으로 발생하는 **데이터의 흐름(Flow)과 변화에 `반응(Reactive)`하는 시스템**을 만드는 것에 초점이 맞춰져 있다.

그러니까 시스템 내에서 일어나는 이벤트나 데이터의 변화에 `반응`하는 방식으로 처리한다.

먼저 몇가지 중요한 개념을 정리해보자

## 1️⃣  비동기성(Asynchronous)

비동기 프로그래밍에서는

- 작업이 **동기적으로 차례대로 처리되는 것**이 아니라,
- 여러 작업이 동시에 일어나면서 **결과가 준비되면 알림을 주는 방식**으로 동작한다.
- 예시: 네트워크 요청, 파일 I/O, 데이터베이스 쿼리 등을 동시에 처리할 수 있다.

리액티브 프로그래밍은 비동기적 처리를 더 직관적이고 선언적으로 다룰 수 있도록 도와준다.

## 2️⃣ 데이터 흐름(Flow of Data)

리액티브 프로그래밍에서 중요한 점은 데이터가 흐른다는 점이다.

데이터를 하나하나 처리하는 것에서 벗어나 → 데이터 흐름을 정의하고 그 흐름에 `반응`하는 방식을 사용한다.

예를 들어, 사용자 UI에서 데이터를 실시간으로 처리할 때, 새로운 데이터가 들어오면 자동으로 UI가 갱신되는 구조를 생각해볼 수 있다.

## 3️⃣ Publisher와 Subscriber

리액티브 프로그래밍에서도 **Publisher**와 **Subscriber** 개념을 사용한다.

- **Publisher**: 데이터를 **발행**하는 객체로, 데이터가 변할 때마다 **변경사항을 구독자에게 전달**한다.
- **Subscriber**: Publisher가 발행하는 데이터를 **구독**하는 객체로, **데이터를 받고 처리하는 역할**을 한다.

이 구조는 **옵저버 패턴**(Observer Pattern)이다. 데이터가 변하는 것을 관찰하고 있다가, Publisher는 변경사항을 구독자에게 전달한다. 데이터를 발행하는 측과 데이터를 받는 측이 분리되어 있으며, 구독자는 데이터가 변할 때마다 알림을 받을 수 있다.

## 4️⃣ 리액티브 스트림(Reactive Streams)

리액티브 프로그래밍의 핵심은 **리액티브 스트림**이라는 개념에 있다.

리액티브 스트림 = **비동기적으로 처리되는 데이터 흐름**을 의미. **데이터 `흐름`**과 **변경 사항에 `반응`**하는 방식으로 동작함.

주요 특징

- **Non-blocking**: 처리 중인 작업이 완료되기를 기다리지 않고! 다른 작업을 동시에 처리 함
- **Backpressure**: 데이터가 너무 많이 흘러들어올때, 이를 처리할 수 있는 방법을 제공한다.
    - 예를 들어, 너무 빠르게 도착하는 데이터를 적절하게 처리도록 조절할 수 있다.

## 5️⃣ Flux와 Mono (Project Reactor)

리액티브 프로그래밍을 구현하는데 사용하는 라이브러리로 **Project Reactor**가 있는데 여기서 **Flux**와 **Mono**라는 두가지 주요 타입을 제공한다.

- Mono: 단일 결과를 반환하는 비동기 스트림
    - 예시: 데이터 베이스에서 단일 값을 조회는 경우
- Flux: 여러 결과를 반환하는 비동기 스트림
    - 예시: 여러 개의 데이터가 연속적으로 흐를 때 사용

## 6️⃣ 리액티브 연산자

리액티브 프로그래밍에서는 연산자를 통해 데이터 스트림을 변형하거나 처리할 수 있다.

- map(): 데이터 항목을 변환
- flatMap(); 여러 개의 데이터를 평탄화
- reduce(): 데이터를 결합하거나 축소

### 간단한 코드

```java
import reactor.core.publisher.Flux;

public class ReactiveExample {
		public static void main(String[] args) {
				// Flux를 이용해 비동기 데이터 스트림 생성
				Flux<Integer> numbers = Flux.just(1, 2, 3, 4, 5);
				
				// 각 값을 2배로 변환하여 출력
				numbers.map(n -> n * 2)
								.subscribe(n -> System.out.println("Number: " + n));
		}
}
```

이런 연산자를 조합해서 다양한 데이터 처리 작업을 **비동기적으로** 수행할 수 있다.

## 7️⃣ 리액티브 프로그래밍의 예시

- UI 업데이트: 사용자가 버튼을 클릭했을 때 서버에서 데이터를 받아와 UI를 자동으로 갱신하는 시스템
- 실시간 데이터 처리: 주식 가격이나 날씨 정보를 실시간으로 받아서 화면에 표시하는 시스템
- 파일 다운로드/업로드: 큰 파일을 다운로드하거나 업로드 할 때, 비동기적으로 파일을 처리하면서 +  진행 상태를 업데이트 하는 시스템

## 8️⃣ 리액티브 프로그래밍의 장점

- 효율성: 여러 작업을 비동기적으로 처리할 수 있어서, 자원을 효율적으로 사용할 수 있다.
- 유연성: 데이터 흐름을 정의하고 그 흐름에 `반응`할 수 있기 때문에 시스템이 유연하고 확장성이 높다.
- 스케일링: 높은 동시성을 처리할 수 있기 때문에, 대규모 시스템에서도 성능을 유지할 수 있다.